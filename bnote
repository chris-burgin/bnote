#! /bin/bash -
if [ -n "$1" ]; then
  if [[ "$1" = "--dir" ]]; then
    echo "$(dirname ~/.bnote)/.bnote"
    exit
  fi

  if [[ "$1" = "--yesterday" ]]; then
    yesterday=$(date -r `expr \`date +%s\` - 86400` '+%Y_%m_%d')
    less ~/.bnote/$yesterday.txt
    exit
  fi

  less ~/.bnote/$1.txt
  exit
fi

mkdir -p ~/.bnote/;

date=$(date +'%Y_%m_%d')
time=$(date +"%T")
filename="$date.txt"

if [[ ! -e ~/.bnote/$filename ]]; then
  echo "----------------------" > ~/.bnote/$filename
  echo "--- ${date} log ---" >> ~/.bnote/$filename
  echo "----------------------" >> ~/.bnote/$filename
fi

echo "" >> ~/.bnote/$filename
echo "---" >> ~/.bnote/$filename
echo "$time" >> ~/.bnote/$filename
echo "---" >> ~/.bnote/$filename
vim '+normal Go' ~/.bnote/$filename
